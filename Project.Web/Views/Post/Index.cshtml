@model StopGambleProject.Models.Post.PostIndexModel
<br />

<div class="ui raised padded text container post segment" style="padding-top:20px;">
    <div class="ui grid">
        <div class="two column row">
            <div class="two wide column">
                <a class="ui inverted primary button" href="/Forum/Topic/@Model.ForumId">Back to @Model.ForumName</a>
            </div>
            <div class="fourteen wide column">
                <h1>
                    @Model.Title
                </h1>
            </div>
        </div>
    </div>
</div>

<div style="padding-top:25px;">
<div class="ui raised very padded text container post segment">
  <h2 class="ui left floated header"><img src="@Model.AuthorImageUrl">@Model.Title</h2>
  <div class="ui clearing divider"></div>
    <p>@Model.Content</p>
   
    <p>   @if (Model.IsAdmin && Model.IsModerator)
          {
              <i class="chess queen icon" style="color:gold"></i>
          } else if (Model.IsModerator && !Model.IsAdmin)
        {
            <i class="chess queen icon" style="color:blue"></i>
        }<a href="/Profile/Detail/@Model.AuthorId">@Model.AuthorName</a> (@Model.AuthorRating) - @Model.Created</p>
    <div class="ui fitted divider"></div>
                <br>
    <div class="ui grid">
        <div class="three column row">
            @if (User.Identity.IsAuthenticated)
            {
                <div class="two wide column">
                    <a href="/Reply/Create/@Model.Id" class="ui green button">Reply</a>
                </div>
            }
            @if (User.Identity.Name == Model.AuthorName || User.IsInRole("Admin") || User.IsInRole("Moderator"))
            {
                <div class="two wide column">
                    <button class="ui blue button editButton" type="button" id="editPostButton">Edit</button>
                </div>
            }
            @if (User.IsInRole("Admin") || User.IsInRole("Moderator"))
            {
                <div class="two wide column">
                    <button class="ui button red deleteButton" type="button" id="deletePostButton">Delete</button>
                </div>
            }
        </div>
                </div>
</div>
</div>
@if (Model.Replies.Any())
{
    foreach (var reply in Model.Replies)
    {
        <div class="ui raised very padded text container post segment">
            <h3 class="ui left floated header"><img src="@reply.AuthorImageUrl">
                <span>
                    @if (@reply.IsAdmin)
                    {
                        <i class="chess queen icon" style="color:gold; margin-right: 0"></i>
                    }
                    else if (Model.IsModerator && !Model.IsAdmin)
                    {
                        <i class="chess queen icon" style="color:blue;margin-right: 0"></i>
                    }
                </span> <a href="/Profile/Detail/@reply.AuthorId">@reply.AuthorName</a> (@reply.AuthorRating)</h3>
            <div class="ui clearing divider"></div>
            <p>@reply.ReplyContent</p>

            <div class="ui fitted divider"></div>
            <br>
            <div class="ui grid">
                <div class="three column row">
                   @if (User.IsInRole("Admin") || User.IsInRole("Moderator"))
                   {
                       <div class="one wide column">
                           <button class="ui button red deleteButton" type="button" id="deleteReplyButton">Delete</button>
                       </div>
                   }
                </div>
            </div>
        </div>
    }
}
else
{
    <div class="ui raised very padded text container segment">
        @if (User.Identity.IsAuthenticated)
        {
            <p>There are no replies to this post, why not create one?</p>
            <a href="/Reply/Create/@Model.Id" class="ui green button">Reply</a>
        }
        else
        {
            <p>There are currently no replies to this post, would you like to <a href="/Identity/Account/Register">register</a> to join in on the discussion?</p>
        }
    </div>
}
<br>

@*Modal Edit Post Popup*@
<div class="ui modal editPost">
    <i class="close icon"></i>
    <div class="header">
        Edit post
    </div>
    <div class="image content">
        <div class="description">
            <form asp-action="Edit" method="post" class="ui form" id="editPostForm">
                <div class="field">
                    <label asp-for="Title"></label>
                    <input asp-for="Title" class="form-control" />
                </div>
                <div class="field">
                    <label asp-for="Content"></label>
                    <textarea asp-for="Content" class="form-control" rows="20" placeholder="Your post...">@Model.Content</textarea>
                </div>
                <div class="actions">
                    <div class="ui black deny button">
                        Cancel
                    </div>
                    <button type="submit" class="ui blue button">Edit Post</a>
                </div>
                <input asp-for="ForumId" type="hidden" />
                <input asp-for="Id" type="hidden" />
            </form>
        </div>
    </div>
</div>
@*End Edit popup *@

@*Modal Delete Post Popup*@
<div class="ui modal deletePost">
    <i class="close icon"></i>
    <div class="header">
        Delete post
    </div>
    <div class="image content">
        <div class="description">
            <div class="ui header">@Model.Title</div>
            <p>@Model.Content</p>

            @if (Model.PostReplyCount > 1)
            {
                <div class="ui icon red message">
                    <i class="notched circle loading icon"></i>
                    <div class="content">
                        <div class="header">
                            Warning
                        </div>
                        <p>This will also delete the @Model.PostReplyCount replies associated with this post.</p>
                    </div>
                </div>
            }
            else if(Model.PostReplyCount == 1)
            {
                <div class="ui icon red message">
                    <i class="notched circle loading icon"></i>
                    <div class="content">
                        <div class="header">
                            Warning
                        </div>
                        <p>This will also delete the 1 reply associated with this post.</p>
                    </div>
                </div>
            }

        </div>
    </div>
    <div class="actions">
        <div class="ui black deny button">
            Cancel
        </div>
        <a asp-controller="Post" asp-action="DeletePost" asp-route-id="@Model.Id" class="ui red button">Delete</a>
    </div>
</div>
@*End Delete popup *@
